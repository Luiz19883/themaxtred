<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE MAX - VIP Dashboard</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="assets/modern-vip.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobile-overlay" onclick="toggleMobileMenu()"></div>

    <div class="app-container">

        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="brand">
                <img src="assets/logo-the-max-dex.jpg" alt="THE MAX DEX" class="brand-logo">
            </div>

            <nav class="nav-menu">
                <div class="nav-item active" onclick="switchView('dashboard')">
                    <i data-lucide="layout-dashboard"></i> Dashboard
                </div>
                <div class="nav-item" onclick="switchView('signals')">
                    <i data-lucide="zap"></i> Live Signals
                </div>
                <div class="nav-item" onclick="switchView('watchlist')">
                    <i data-lucide="star"></i> Watchlist
                </div>
                <div class="nav-item" onclick="switchView('blockchain')">
                    <i data-lucide="link"></i> Blockchain
                </div>
                <div class="nav-item" onclick="switchView('insights')">
                    <i data-lucide="brain"></i> Studies & Insights
                </div>
                <div class="nav-item" onclick="switchView('alerts')">
                    <i data-lucide="bell"></i> Alerts
                    <span id="active-alerts-badge" class="alert-notification-badge" style="display:none;">0</span>
                </div>
                <div class="nav-item" onclick="switchView('risk')">
                    <i data-lucide="calculator"></i> Risk Management
                </div>
                <div class="nav-item" onclick="window.location.href='admin.html'">
                    <i data-lucide="shield"></i> Admin
                </div>
            </nav>

            <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                <div class="nav-item" onclick="toggleTheme()">
                    <i data-lucide="moon"></i> Toggle Theme
                </div>
                <div class="nav-item" onclick="toggleAutoTrade()">
                    <i data-lucide="bot"></i> Auto Trade
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <div class="page-title">
                    <h1 id="page-title">Dashboard</h1>
                    <p>Real-time market monitoring</p>
                </div>

                <div class="status-indicators">
                    <div class="status-badge">
                        <div class="status-dot"></div>
                        <span id="connection-status">Connected</span>
                    </div>
                    <div class="status-badge">
                        <i data-lucide="clock" style="width: 16px; height: 16px;"></i>
                        <select id="update-interval" onchange="changeUpdateInterval()"
                            style="background:transparent; border:none; color:white; font-family:inherit; cursor:pointer; outline:none;">
                            <option value="manual" style="background:#222;">Manual</option>
                            <option value="15" style="background:#222;">15min</option>
                            <option value="30" style="background:#222;">30min</option>
                            <option value="40" style="background:#222;">40min</option>
                        </select>
                    </div>
                    <div class="status-badge">
                        <span style="cursor:pointer;" onclick="atualizar()" title="Update Now"><i
                                data-lucide="refresh-cw" style="width: 16px; height: 16px;"></i></span>
                        <span id="last-update">--:--</span>
                    </div>
                    <div class="status-badge">
                        <i data-lucide="radio" style="width: 16px; height: 16px;"></i>
                        <span id="signal-count">0</span> Signals
                    </div>
                </div>
            </header>

            <!-- Views Container -->
            <div id="views-container">

                <!-- Dashboard View (Default) -->
                <div id="view-dashboard" class="view-section">
                    <div class="glass-panel">
                        <div class="panel-header">
                            <span class="panel-title">Auto Trade</span>
                            <div class="status-dot" id="auto-trade-dot" style="background: #555;"></div>
                        </div>
                        <div id="auto-trade-stats">
                            <h3 style="margin-bottom: 20px;">Recent Signals</h3>
                            <div id="signals-grid-dashboard" class="dashboard-grid"></div>
                        </div>
                    </div>
                </div>

                <!-- Signals View -->
                <div id="view-signals" class="view-section" style="display: none;">
                    <div class="panel-header">
                        <div class="search-bar" style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <input type="text" id="search-input" placeholder="Search pair (e.g. BTC)..."
                                style="background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); padding: 10px; border-radius: 8px; color: white; flex: 1;">
                            <button onclick="performSearch()"
                                style="background: var(--primary); border: none; padding: 0 20px; border-radius: 8px; font-weight: bold; cursor: pointer; color: #000;">Search</button>
                            <button onclick="atualizar()"
                                style="background: var(--accent); border: none; padding: 0 20px; border-radius: 8px; font-weight: bold; cursor: pointer; color: #fff;">ðŸ”„
                                Update</button>
                        </div>
                        <div class="filters" style="display: flex; gap: 10px;">
                            <button class="nav-item active" onclick="filterSignals('all')">All</button>
                            <button class="nav-item" onclick="filterSignals('long')">Long</button>
                            <button class="nav-item" onclick="filterSignals('short')">Short</button>
                        </div>
                    </div>
                    <div id="signals-grid-main" class="dashboard-grid"></div>
                </div>

                <!-- Watchlist View -->
                <div id="view-watchlist" class="view-section" style="display: none;">
                    <div class="glass-panel">
                        <div class="panel-header">
                            <span class="panel-title">My Favorite Pairs</span>
                            <button onclick="addToWatchlistUI()"
                                style="background: var(--primary); border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; color: #000; font-weight: 600;">+
                                Add</button>
                        </div>
                        <div id="watchlist-content"></div>
                    </div>
                </div>

                <!-- Blockchain View -->
                <div id="view-blockchain" class="view-section" style="display: none;">
                    <div class="glass-panel">
                        <div class="panel-header">
                            <span class="panel-title">Web3 Connection</span>
                        </div>
                        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <button class="nav-item active" onclick="switchBlockchain('eth')">Ethereum</button>
                            <button class="nav-item" onclick="switchBlockchain('bnb')">BSC</button>
                            <button class="nav-item" onclick="switchBlockchain('sol')">Solana</button>
                        </div>

                        <div class="wallet-connect-area" style="text-align: center; padding: 40px;">
                            <button id="connect-wallet-btn" onclick="connectWallet()"
                                style="background: linear-gradient(135deg, #9945ff, #6b21a8); border: none; padding: 12px 24px; border-radius: 8px; color: white; font-weight: bold; font-size: 16px; cursor: pointer;">
                                ðŸ”Œ Connect Wallet
                            </button>
                            <div id="wallet-info" style="margin-top: 20px;"></div>
                        </div>

                        <div id="blockchain-data-display" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <!-- Insights View -->
                <div id="view-insights" class="view-section" style="display: none;">
                    <div class="glass-panel">
                        <div class="panel-header">
                            <span class="panel-title">Market Studies</span>
                        </div>
                        <div id="insights-content">
                            <!-- Content will be loaded dynamically -->
                            <p>Loading insights...</p>
                        </div>
                    </div>
                </div>

                <!-- Alerts View -->
                <div id="view-alerts" class="view-section" style="display: none;">
                    <div class="glass-panel">
                        <div class="panel-header">
                            <span class="panel-title">Alert Management</span>
                            <button onclick="createNewAlert()" class="btn-primary">+ New Alert</button>
                        </div>
                        <div id="alerts-list"></div>
                    </div>
                </div>

                <!-- Risk View -->
                <div id="view-risk" class="view-section" style="display: none;">
                    <div class="glass-panel">
                        <div class="panel-header">
                            <span class="panel-title">Risk Calculator</span>
                        </div>
                        <div id="risk-calculator-content"></div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Copy Trade Button (Floating) -->
    <button id="last-copy-btn" onclick="openLastCopyTrade()" style="display: none;" class="floating-action-btn"
        title="View last copied trade">
        <i data-lucide="clipboard-copy"></i>
    </button>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- App Logic -->
    <script src="js/theme-system.js"></script>
    <script src="js/web3-wallet.js"></script>
    <script src="js/ai-analysis.js"></script>
    <script src="js/risk-manager.js"></script>
    <script src="js/alert-manager.js"></script>
    <script src="js/realtime-analysis.js"></script>
    <script type="module" src="js/main.js"></script>

    <!-- Mobile Menu Logic -->
    <script>
        function toggleMobileMenu() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('mobile-overlay');
            const menuBtn = document.querySelector('.mobile-menu-btn');

            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
            if (menuBtn) menuBtn.classList.toggle('active');
        }

        // Close menu when clicking on nav item (mobile)
        document.addEventListener('DOMContentLoaded', () => {
            // Re-init icons if needed, though main.js does it too
            if (window.lucide) lucide.createIcons();

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        toggleMobileMenu();
                    }
                });
            });
        });
    </script>
</body>

</html>